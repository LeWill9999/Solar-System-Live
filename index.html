<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="theme-color" content="#000000">
    <title>Solar System - Real-time View</title>
    <style>
        /* Mobile-friendly styles */
        @media (max-width: 768px) {
            body {
                perspective: 1000px;
            }
            
            .solar-system {
                transform: rotateX(60deg) rotateZ(45deg) scale(0.4);
            }

            .planet-name, .asteroid-name, .comet-name, .satellite-name, .spacecraft-name {
                font-size: 14px !important;
            }

            /* Add touch-friendly hover states */
            .planet:active,
            .asteroid:active,
            .comet:active,
            .satellite:active,
            .spacecraft:active {
                transform: translate(-50%, -50%) scale(1.2);
            }

            /* Adjust datetime display for mobile */
            .datetime-display {
                font-size: 14px;
                padding: 5px;
                background: rgba(0, 0, 0, 0.8);
            }
        }

        /* Add pinch-zoom support */
        @media (hover: none) {
            body {
                touch-action: manipulation;
            }
            
            .solar-system {
                transition: transform 0.3s ease;
            }
        }

        body {
            margin: 0;
            height: 100vh;
            background: #000;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: Arial, sans-serif;
            perspective: 2000px;
            color: white;
            transition: perspective 1s ease;
        }

        .datetime-display {
            position: fixed;
            top: 20px;
            left: 20px;
            font-size: 18px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
            z-index: 1000;
        }

        /* 3D Grid System */
        .grid-container {
            position: absolute;
            width: 3000px;
            height: 2000px;
            transform-style: preserve-3d;
        }

        .grid {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }

        .grid-line {
            position: absolute;
            background: rgba(255, 255, 255, 0.1);
        }

        /* X-axis grid lines (vertical lines) */
        .grid-x {
            width: 1px;
            height: 100%;
            transform-style: preserve-3d;
        }

        /* Y-axis grid lines (horizontal lines) */
        .grid-y {
            width: 100%;
            height: 1px;
            transform-style: preserve-3d;
        }

        /* Z-axis grid lines (depth lines) */
        .grid-z {
            width: 1px;
            height: 1px;
            transform-style: preserve-3d;
            background: rgba(255, 255, 255, 0.05);
        }

        /* Axis labels */
        .axis-label {
            position: absolute;
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
            font-weight: bold;
        }

        .solar-system {
            position: relative;
            width: 3000px;
            height: 2000px;
            transform: rotateX(60deg) rotateZ(45deg);
            transform-style: preserve-3d;
            transform-origin: center center;
        }

        .sun {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: radial-gradient(circle at 30% 30%, 
                #fff 0%, 
                #ffd700 20%, 
                #ff8c00 40%, 
                #ff4500 100%);
            border-radius: 50%;
            box-shadow: 0 0 40px rgba(255, 69, 0, 0.2);
            z-index: 1;
        }

        .orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            pointer-events: none;
        }

        .planet-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-origin: 50% 50%;
            transform-style: preserve-3d;
            display: block !important;
            visibility: visible !important;
            pointer-events: auto;
            z-index: 10;
            width: 0;
            height: 0;
        }

        .planet {
            position: absolute;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: all 0.3s ease;
            will-change: transform;
            display: block !important;
            visibility: visible !important;
            border-radius: 50% !important;
            z-index: inherit;
            pointer-events: auto;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            opacity: 1 !important;
            background-color: currentColor !important;
        }

        .planet-name {
            position: absolute;
            color: #fff;
            white-space: nowrap;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
            background: rgba(0, 0, 0, 0.9);
            padding: 2px 6px;
            border-radius: 3px;
            pointer-events: none;
            transition: all 0.3s ease;
            transform: translateY(-35px) translateX(-50%);
            left: 50%;
            top: 100%;
            z-index: 1000;
        }

        .planet:hover .planet-name {
            transform: translateY(-35px) translateX(-50%);
            font-size: 16px;
            background: rgba(0, 0, 0, 0.9);
        }

        /* Mercury */
        #mercury-orbit { width: 160px; height: 160px; }
        #mercury {
            width: 12px !important;
            height: 12px !important;
            background: radial-gradient(circle at 30% 30%,
                #ffd700 0%,
                #a67f59 60%,
                #806040 100%) !important;
            box-shadow: inset -2px -2px 4px rgba(0,0,0,0.5),
                        inset 2px 2px 4px rgba(255,255,255,0.3),
                        0 0 20px rgba(255,255,255,0.4);
            display: block !important;
            visibility: visible !important;
            z-index: 10 !important;
            border-radius: 50% !important;
        }

        /* Venus */
        #venus-orbit { width: 240px; height: 240px; }
        #venus {
            width: 18px !important;
            height: 18px !important;
            background: radial-gradient(circle at 30% 30%,
                #ffd700 0%,
                #e6b87c 60%,
                #c69c6d 100%) !important;
            box-shadow: inset -3px -3px 6px rgba(0,0,0,0.5),
                        inset 3px 3px 6px rgba(255,255,255,0.3),
                        0 0 25px rgba(255,255,255,0.4);
            display: block !important;
            visibility: visible !important;
            z-index: 11 !important;
            border-radius: 50% !important;
        }

        /* Earth */
        #earth-orbit { width: 320px; height: 320px; }
        #earth {
            width: 20px !important;
            height: 20px !important;
            background: radial-gradient(circle at 30% 30%,
                #50C878 0%,
                #4B90DD 60%,
                #2a5080 100%) !important;
            box-shadow: inset -3px -3px 6px rgba(0,0,0,0.5),
                        inset 3px 3px 6px rgba(255,255,255,0.3),
                        0 0 25px rgba(73, 151, 208, 0.5);
            display: block !important;
            visibility: visible !important;
            z-index: 12 !important;
            border-radius: 50% !important;
        }

        /* Mars */
        #mars-orbit { width: 440px; height: 440px; }
        #mars {
            width: 16px !important;
            height: 16px !important;
            background: radial-gradient(circle at 30% 30%,
                #ff6b6b 0%,
                #c1440e 60%,
                #8b3209 100%) !important;
            box-shadow: inset -3px -3px 6px rgba(0,0,0,0.5),
                        inset 3px 3px 6px rgba(255,255,255,0.3),
                        0 0 25px rgba(193, 68, 14, 0.5);
            display: block !important;
            visibility: visible !important;
            z-index: 13 !important;
            border-radius: 50% !important;
        }

        /* Jupiter */
        #jupiter-orbit { width: 640px; height: 640px; }
        #jupiter {
            width: 40px !important;
            height: 40px !important;
            background: radial-gradient(circle at 30% 30%,
                #e4c19c 0%,
                #c3a992 60%,
                #9a8472 100%) !important;
            box-shadow: inset -5px -5px 10px rgba(0,0,0,0.5),
                        inset 5px 5px 10px rgba(255,255,255,0.3),
                        0 0 30px rgba(195, 169, 146, 0.5);
            display: block !important;
            visibility: visible !important;
            z-index: 14 !important;
            border-radius: 50% !important;
        }

        /* Saturn */
        #saturn-orbit { width: 800px; height: 800px; }
        #saturn {
            width: 35px !important;
            height: 35px !important;
            background: radial-gradient(circle at 30% 30%,
                #ffd700 0%,
                #ffa500 60%,
                #cc8400 100%) !important;
            box-shadow: inset -4px -4px 8px rgba(0,0,0,0.5),
                        inset 4px 4px 8px rgba(255,255,255,0.3),
                        0 0 30px rgba(255, 215, 0, 0.5);
            display: block !important;
            visibility: visible !important;
            z-index: 15 !important;
            border-radius: 50% !important;
        }
        .saturn-rings {
            position: absolute;
            width: 70px;
            height: 15px;
            background: linear-gradient(to bottom,
                rgba(255, 215, 0, 0.4),
                rgba(255, 215, 0, 0.2) 48%,
                transparent 50%,
                rgba(255, 215, 0, 0.2) 52%,
                rgba(255, 215, 0, 0.4)
            );
            border-radius: 50%;
            transform: translateX(-50%) translateY(-50%) rotateX(75deg);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            z-index: 4;
        }

        /* Uranus */
        #uranus-orbit { width: 960px; height: 960px; }
        #uranus {
            width: 26px !important;
            height: 26px !important;
            background: radial-gradient(circle at 30% 30%,
                #00ced1 0%,
                #b2ffff 60%,
                #89cccc 100%) !important;
            box-shadow: inset -4px -4px 8px rgba(0,0,0,0.5),
                        inset 4px 4px 8px rgba(255,255,255,0.3),
                        0 0 25px rgba(0, 206, 209, 0.5);
            display: block !important;
            visibility: visible !important;
            z-index: 16 !important;
            border-radius: 50% !important;
        }

        /* Neptune */
        #neptune-orbit { width: 1120px; height: 1120px; }
        #neptune {
            width: 25px !important;
            height: 25px !important;
            background: radial-gradient(circle at 30% 30%,
                #00bfff 0%,
                #4169e1 60%,
                #2a4594 100%) !important;
            box-shadow: inset -4px -4px 8px rgba(0,0,0,0.5),
                        inset 4px 4px 8px rgba(255,255,255,0.3),
                        0 0 25px rgba(65, 105, 225, 0.5);
            display: block !important;
            visibility: visible !important;
            z-index: 17 !important;
            border-radius: 50% !important;
        }

        /* Pluto */
        #pluto-orbit { width: 1400px; height: 1400px; }
        #pluto {
            width: 10px !important;
            height: 10px !important;
            background: radial-gradient(circle at 30% 30%,
                #deb887 0%,
                #8b7355 60%,
                #6b4423 100%) !important;
            box-shadow: inset -2px -2px 4px rgba(0,0,0,0.5),
                        inset 2px 2px 4px rgba(255,255,255,0.3),
                        0 0 20px rgba(222, 184, 135, 0.4);
            display: block !important;
            visibility: visible !important;
            z-index: 18 !important;
            border-radius: 50% !important;
        }

        .planet-container:hover .planet-name {
            font-size: 20px;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(255,255,255,0.8);
            background: rgba(0, 0, 0, 0.9);
        }

        .planet-container:hover .planet {
            box-shadow: -8px -8px 15px rgba(0,0,0,0.8) inset,
                        0 0 100px rgba(255,255,255,0.8);
        }

        /* Orbit widths for JavaScript calculations */
        .planet-container#mercury-container { --orbit-width: 160px; }
        .planet-container#venus-container { --orbit-width: 240px; }
        .planet-container#earth-container { --orbit-width: 320px; }
        .planet-container#mars-container { --orbit-width: 440px; }
        .planet-container#jupiter-container { --orbit-width: 640px; }
        .planet-container#saturn-container { --orbit-width: 800px; }
        .planet-container#uranus-container { --orbit-width: 960px; }
        .planet-container#neptune-container { --orbit-width: 1120px; }
        .planet-container#pluto-container { --orbit-width: 1400px; }

        /* Remove zoom-related styles */
        .zoom-controls,
        .zoom-button {
            display: none;
        }

        /* Enhance planet hover effects */
        .planet:hover {
            transform: translate(-50%, -50%) scale(1.1) rotateY(45deg);
            box-shadow: inset -6px -6px 12px rgba(0,0,0,0.6),
                        inset 6px 6px 12px rgba(255,255,255,0.4),
                        0 0 40px rgba(255,255,255,0.6);
        }

        /* Ensure names are always visible */
        .planet-name {
            z-index: 1000 !important;
            background: rgba(0, 0, 0, 0.8) !important;
            padding: 4px 8px !important;
            white-space: nowrap !important;
            pointer-events: none !important;
            font-weight: bold !important;
        }

        /* Asteroid styles */
        .asteroid {
            position: absolute;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: all 0.3s ease;
            will-change: transform;
            display: block !important;
            visibility: visible !important;
            border-radius: 50% !important;
            z-index: inherit;
            pointer-events: auto;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
            opacity: 1 !important;
            background: radial-gradient(circle at 30% 30%,
                #8B7355 0%,
                #6B4423 60%,
                #483C32 100%) !important;
        }

        .asteroid-name {
            position: absolute;
            color: #ffd700;
            white-space: nowrap;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
            background: rgba(0, 0, 0, 0.9);
            padding: 2px 6px;
            border-radius: 3px;
            pointer-events: none;
            transition: all 0.3s ease;
            transform: translateY(-25px) translateX(-50%);
            left: 50%;
            top: 100%;
            z-index: 1000;
            font-size: 12px;
        }

        .asteroid:hover .asteroid-name {
            transform: translateY(-30px) translateX(-50%);
            font-size: 14px;
            background: rgba(0, 0, 0, 0.9);
        }

        /* Individual asteroid sizes */
        #ceres { width: 14px; height: 14px; }
        #vesta { width: 12px; height: 12px; }
        #pallas { width: 11px; height: 11px; }
        #hygiea { width: 10px; height: 10px; }
        #interamnia { width: 9px; height: 9px; }
        #europa { width: 9px; height: 9px; }
        #davida { width: 8px; height: 8px; }
        #sylvia { width: 8px; height: 8px; }
        #cybele { width: 8px; height: 8px; }
        #eunomia { width: 8px; height: 8px; }

        /* Asteroid orbit styles */
        .asteroid-orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 1px dashed rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            pointer-events: none;
        }

        /* Update planet containers for 3D */
        .planet-container {
            transform-style: preserve-3d;
        }

        .planet, .asteroid {
            transform-style: preserve-3d;
        }

        /* Orbit styles update for 3D */
        .orbit, .asteroid-orbit {
            transform-style: preserve-3d;
        }

        /* Comet styles */
        .comet {
            position: absolute;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: all 0.3s ease;
            will-change: transform;
            display: block !important;
            visibility: visible !important;
            border-radius: 50% !important;
            z-index: inherit;
            pointer-events: auto;
            opacity: 1 !important;
        }

        .comet-head {
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 30% 30%,
                #fff 0%,
                #a5f2f3 40%,
                #60a6a8 100%) !important;
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(165, 242, 243, 0.6);
        }

        .comet-tail {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 40px;
            height: 3px;
            background: linear-gradient(to left, 
                rgba(165, 242, 243, 0.8) 0%,
                rgba(165, 242, 243, 0.4) 50%,
                rgba(165, 242, 243, 0) 100%);
            transform-origin: left center;
            pointer-events: none;
            filter: blur(1px);
        }

        .comet-name {
            position: absolute;
            color: #a5f2f3;
            white-space: nowrap;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
            background: rgba(0, 0, 0, 0.9);
            padding: 2px 6px;
            border-radius: 3px;
            pointer-events: none;
            transition: all 0.3s ease;
            transform: translateY(-25px) translateX(-50%);
            left: 50%;
            top: 100%;
            z-index: 1000;
            font-size: 12px;
        }

        .comet:hover .comet-name {
            transform: translateY(-30px) translateX(-50%);
            font-size: 14px;
            background: rgba(0, 0, 0, 0.9);
        }

        /* Individual comet sizes */
        #halley { width: 16px; height: 16px; }
        #hale-bopp { width: 15px; height: 15px; }
        #encke { width: 14px; height: 14px; }
        #tempel1 { width: 13px; height: 13px; }
        #wild2 { width: 12px; height: 12px; }
        #churyumov { width: 12px; height: 12px; }
        #swift-tuttle { width: 11px; height: 11px; }
        #borrelly { width: 11px; height: 11px; }
        #giacobini { width: 10px; height: 10px; }
        #hartley2 { width: 10px; height: 10px; }

        /* Comet orbit styles */
        .comet-orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 1px dotted rgba(165, 242, 243, 0.15);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            pointer-events: none;
        }

        /* Satellite styles */
        .satellite-orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transform-style: preserve-3d;
            pointer-events: none;
        }

        .satellite-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-origin: 50% 50%;
            transform-style: preserve-3d;
            pointer-events: auto;
        }

        .satellite {
            position: absolute;
            transform: translate(-50%, -50%);
            cursor: pointer;
            border-radius: 50%;
            transition: all 0.3s ease;
            will-change: transform;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
        }

        .satellite-name {
            position: absolute;
            color: #b0c4de; /* Changed from #a5f2f3 to a soft silver-blue */
            white-space: nowrap;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
            background: rgba(0, 0, 0, 0.7);
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 10px;
            transform: translateY(-20px) translateX(-50%);
            left: 50%;
            top: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        /* Earth's Moon */
        #moon-orbit { width: 40px; height: 40px; }
        #moon {
            width: 5px;
            height: 5px;
            background: radial-gradient(circle at 30% 30%,
                #fff 0%,
                #d3d3d3 60%,
                #a9a9a9 100%);
        }

        /* Mars' Moons */
        #phobos-orbit { width: 25px; height: 25px; }
        #deimos-orbit { width: 35px; height: 35px; }
        #phobos, #deimos {
            width: 2px;
            height: 2px;
            background: radial-gradient(circle at 30% 30%,
                #a9a9a9 0%,
                #808080 100%);
        }

        /* Jupiter's Galilean Moons */
        #io-orbit { width: 60px; height: 60px; }
        #europa-orbit { width: 80px; height: 80px; }
        #ganymede-orbit { width: 100px; height: 100px; }
        #callisto-orbit { width: 120px; height: 120px; }

        #io {
            width: 4px;
            height: 4px;
            background: radial-gradient(circle at 30% 30%,
                #ffd700 0%,
                #ff8c00 100%);
        }

        #europa {
            width: 4px;
            height: 4px;
            background: radial-gradient(circle at 30% 30%,
                #f0f8ff 0%,
                #87ceeb 100%);
        }

        #ganymede {
            width: 6px;
            height: 6px;
            background: radial-gradient(circle at 30% 30%,
                #8b4513 0%,
                #654321 100%);
        }

        #callisto {
            width: 5px;
            height: 5px;
            background: radial-gradient(circle at 30% 30%,
                #696969 0%,
                #2f4f4f 100%);
        }

        /* Saturn's Major Moons */
        #titan-orbit { width: 90px; height: 90px; }
        #rhea-orbit { width: 70px; height: 70px; }
        #iapetus-orbit { width: 110px; height: 110px; }

        #titan {
            width: 5px;
            height: 5px;
            background: radial-gradient(circle at 30% 30%,
                #ffa500 0%,
                #8b4513 100%);
        }

        #rhea, #iapetus {
            width: 3px;
            height: 3px;
            background: radial-gradient(circle at 30% 30%,
                #f5f5f5 0%,
                #a9a9a9 100%);
        }

        /* Uranus' Major Moons */
        #titania-orbit { width: 70px; height: 70px; }
        #oberon-orbit { width: 85px; height: 85px; }
        #miranda-orbit { width: 55px; height: 55px; }

        #titania, #oberon, #miranda {
            width: 3px;
            height: 3px;
            background: radial-gradient(circle at 30% 30%,
                #e0ffff 0%,
                #5f9ea0 100%);
        }

        /* Neptune's Triton */
        #triton-orbit { width: 70px; height: 70px; }
        #triton {
            width: 4px;
            height: 4px;
            background: radial-gradient(circle at 30% 30%,
                #b0e0e6 0%,
                #4682b4 100%);
        }

        #pluto-container {
            display: block !important;
            visibility: visible !important;
            z-index: 18;
            transform-style: preserve-3d;
        }

        #pluto {
            width: 10px !important;
            height: 10px !important;
            background: radial-gradient(circle at 30% 30%,
                #deb887 0%,
                #8b7355 60%,
                #6b4423 100%) !important;
            box-shadow: inset -2px -2px 4px rgba(0,0,0,0.5),
                        inset 2px 2px 4px rgba(255,255,255,0.3),
                        0 0 20px rgba(222, 184, 135, 0.4);
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            z-index: 18 !important;
            border-radius: 50% !important;
            transform-style: preserve-3d;
        }

        /* Spacecraft and Artificial Satellites */
        .spacecraft {
            position: absolute;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: all 0.3s ease;
            will-change: transform;
            display: block !important;
            visibility: visible !important;
            z-index: inherit;
            pointer-events: auto;
        }

        .spacecraft-body {
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 30% 30%,
                #e0e0e0 0%,
                #a0a0a0 60%,
                #808080 100%);
            border-radius: 2px;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.4);
        }

        .spacecraft-name {
            position: absolute;
            color: #98fb98; /* Pale green to distinguish from other objects */
            white-space: nowrap;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
            background: rgba(0, 0, 0, 0.7);
            padding: 2px 4px;
            border-radius: 3px;
            font-size: 10px;
            transform: translateY(-20px) translateX(-50%);
            left: 50%;
            top: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .spacecraft-orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 1px dashed rgba(152, 251, 152, 0.2); /* Pale green orbit */
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transform-style: preserve-3d;
            pointer-events: none;
        }

        /* Individual spacecraft sizes and styles */
        #voyager1 {
            width: 8px;
            height: 8px;
            background: radial-gradient(circle at 30% 30%,
                #ffd700 0%,
                #daa520 100%);
        }

        #voyager2 {
            width: 8px;
            height: 8px;
            background: radial-gradient(circle at 30% 30%,
                #ffd700 0%,
                #daa520 100%);
        }

        #jwst { /* James Webb Space Telescope */
            width: 10px;
            height: 10px;
            background: radial-gradient(circle at 30% 30%,
                #ffd700 0%,
                #b8860b 100%);
        }

        #iss { /* International Space Station */
            width: 12px;
            height: 6px;
            background: radial-gradient(circle at 30% 30%,
                #f0f8ff 0%,
                #b0c4de 100%);
        }

        #hubble {
            width: 9px;
            height: 9px;
            background: radial-gradient(circle at 30% 30%,
                #e6e6fa 0%,
                #9370db 100%);
        }

        #parker { /* Parker Solar Probe */
            width: 7px;
            height: 7px;
            background: radial-gradient(circle at 30% 30%,
                #ff4500 0%,
                #8b0000 100%);
        }

        #new_horizons {
            width: 8px;
            height: 8px;
            background: radial-gradient(circle at 30% 30%,
                #add8e6 0%,
                #4682b4 100%);
        }

        #cassini {
            width: 9px;
            height: 9px;
            background: radial-gradient(circle at 30% 30%,
                #dda0dd 0%,
                #8b008b 100%);
        }

        #juno {
            width: 8px;
            height: 8px;
            background: radial-gradient(circle at 30% 30%,
                #f0e68c 0%,
                #bdb76b 100%);
        }

        #maven {
            width: 7px;
            height: 7px;
            background: radial-gradient(circle at 30% 30%,
                #fa8072 0%,
                #cd5c5c 100%);
        }

        /* Spacecraft orbit styles */
        .spacecraft-orbit {
            position: absolute;
            top: 50%;
            left: 50%;
            border: 1px dashed rgba(152, 251, 152, 0.2); /* Pale green orbit */
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transform-style: preserve-3d;
            pointer-events: none;
        }

        /* Earth-orbiting satellite styles */
        #iss-orbit, #hubble-orbit {
            border: 1px solid rgba(152, 251, 152, 0.4); /* Brighter green for Earth satellites */
            position: absolute;
            transform: translate(-50%, -50%);
            z-index: 1001; /* Above Earth but below spacecraft */
        }

        #iss, #hubble {
            width: 6px !important;
            height: 6px !important;
            background: radial-gradient(circle at 30% 30%,
                #e0e0e0 0%,
                #a0a0a0 60%,
                #808080 100%) !important;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <div class="datetime-display">
        <div id="current-date"></div>
        <div id="current-time"></div>
    </div>

    <div class="grid-container">
        <!-- Grid will be generated by JavaScript -->
    </div>
    
    <div class="solar-system">
        <div class="sun"></div>

        <div class="orbit" id="mercury-orbit"></div>
        <div class="planet-container" id="mercury-container">
            <div class="planet" id="mercury">
                <div class="planet-name">Mercury</div>
            </div>
        </div>

        <div class="orbit" id="venus-orbit"></div>
        <div class="planet-container" id="venus-container">
            <div class="planet" id="venus">
                <div class="planet-name">Venus</div>
            </div>
        </div>

        <div class="orbit" id="earth-orbit"></div>
        <div class="planet-container" id="earth-container">
            <div class="planet" id="earth">
                <div class="planet-name">Earth</div>
            </div>
            <div class="satellite-orbit" id="moon-orbit"></div>
            <div class="satellite-container" id="moon-container">
                <div class="satellite" id="moon">
                    <div class="satellite-name">Moon</div>
                </div>
            </div>
        </div>

        <div class="orbit" id="mars-orbit"></div>
        <div class="planet-container" id="mars-container">
            <div class="planet" id="mars">
                <div class="planet-name">Mars</div>
            </div>
            <div class="satellite-orbit" id="phobos-orbit"></div>
            <div class="satellite-container" id="phobos-container">
                <div class="satellite" id="phobos">
                    <div class="satellite-name">Phobos</div>
                </div>
            </div>
            <div class="satellite-orbit" id="deimos-orbit"></div>
            <div class="satellite-container" id="deimos-container">
                <div class="satellite" id="deimos">
                    <div class="satellite-name">Deimos</div>
                </div>
            </div>
        </div>

        <div class="orbit" id="jupiter-orbit"></div>
        <div class="planet-container" id="jupiter-container">
            <div class="planet" id="jupiter">
                <div class="planet-name">Jupiter</div>
            </div>
            <div class="satellite-orbit" id="io-orbit"></div>
            <div class="satellite-container" id="io-container">
                <div class="satellite" id="io">
                    <div class="satellite-name">Io</div>
                </div>
            </div>
            <div class="satellite-orbit" id="europa-orbit"></div>
            <div class="satellite-container" id="europa-container">
                <div class="satellite" id="europa">
                    <div class="satellite-name">Europa</div>
                </div>
            </div>
            <div class="satellite-orbit" id="ganymede-orbit"></div>
            <div class="satellite-container" id="ganymede-container">
                <div class="satellite" id="ganymede">
                    <div class="satellite-name">Ganymede</div>
                </div>
            </div>
            <div class="satellite-orbit" id="callisto-orbit"></div>
            <div class="satellite-container" id="callisto-container">
                <div class="satellite" id="callisto">
                    <div class="satellite-name">Callisto</div>
                </div>
            </div>
        </div>

        <div class="orbit" id="saturn-orbit"></div>
        <div class="planet-container" id="saturn-container">
            <div class="planet" id="saturn">
                <div class="saturn-rings"></div>
                <div class="planet-name">Saturn</div>
            </div>
            <div class="satellite-orbit" id="titan-orbit"></div>
            <div class="satellite-container" id="titan-container">
                <div class="satellite" id="titan">
                    <div class="satellite-name">Titan</div>
                </div>
            </div>
            <div class="satellite-orbit" id="rhea-orbit"></div>
            <div class="satellite-container" id="rhea-container">
                <div class="satellite" id="rhea">
                    <div class="satellite-name">Rhea</div>
                </div>
            </div>
            <div class="satellite-orbit" id="iapetus-orbit"></div>
            <div class="satellite-container" id="iapetus-container">
                <div class="satellite" id="iapetus">
                    <div class="satellite-name">Iapetus</div>
                </div>
            </div>
        </div>

        <div class="orbit" id="uranus-orbit"></div>
        <div class="planet-container" id="uranus-container">
            <div class="planet" id="uranus">
                <div class="planet-name">Uranus</div>
            </div>
            <div class="satellite-orbit" id="titania-orbit"></div>
            <div class="satellite-container" id="titania-container">
                <div class="satellite" id="titania">
                    <div class="satellite-name">Titania</div>
                </div>
            </div>
            <div class="satellite-orbit" id="oberon-orbit"></div>
            <div class="satellite-container" id="oberon-container">
                <div class="satellite" id="oberon">
                    <div class="satellite-name">Oberon</div>
                </div>
            </div>
            <div class="satellite-orbit" id="miranda-orbit"></div>
            <div class="satellite-container" id="miranda-container">
                <div class="satellite" id="miranda">
                    <div class="satellite-name">Miranda</div>
                </div>
            </div>
        </div>

        <div class="orbit" id="neptune-orbit"></div>
        <div class="planet-container" id="neptune-container">
            <div class="planet" id="neptune">
                <div class="planet-name">Neptune</div>
            </div>
            <div class="satellite-orbit" id="triton-orbit"></div>
            <div class="satellite-container" id="triton-container">
                <div class="satellite" id="triton">
                    <div class="satellite-name">Triton</div>
                </div>
            </div>
        </div>

        <!-- Asteroids -->
        <div class="asteroid-orbit" id="ceres-orbit"></div>
        <div class="planet-container" id="ceres-container">
            <div class="asteroid" id="ceres">
                <div class="asteroid-name">Ceres</div>
            </div>
        </div>

        <div class="asteroid-orbit" id="vesta-orbit"></div>
        <div class="planet-container" id="vesta-container">
            <div class="asteroid" id="vesta">
                <div class="asteroid-name">Vesta</div>
            </div>
        </div>

        <div class="asteroid-orbit" id="pallas-orbit"></div>
        <div class="planet-container" id="pallas-container">
            <div class="asteroid" id="pallas">
                <div class="asteroid-name">Pallas</div>
            </div>
        </div>

        <div class="asteroid-orbit" id="hygiea-orbit"></div>
        <div class="planet-container" id="hygiea-container">
            <div class="asteroid" id="hygiea">
                <div class="asteroid-name">Hygiea</div>
            </div>
        </div>

        <div class="asteroid-orbit" id="interamnia-orbit"></div>
        <div class="planet-container" id="interamnia-container">
            <div class="asteroid" id="interamnia">
                <div class="asteroid-name">Interamnia</div>
            </div>
        </div>

        <div class="asteroid-orbit" id="europa_52-orbit"></div>
        <div class="planet-container" id="europa_52-container">
            <div class="asteroid" id="europa_52">
                <div class="asteroid-name">52 Europa</div>
            </div>
        </div>

        <div class="asteroid-orbit" id="davida-orbit"></div>
        <div class="planet-container" id="davida-container">
            <div class="asteroid" id="davida">
                <div class="asteroid-name">Davida</div>
            </div>
        </div>

        <div class="asteroid-orbit" id="sylvia-orbit"></div>
        <div class="planet-container" id="sylvia-container">
            <div class="asteroid" id="sylvia">
                <div class="asteroid-name">Sylvia</div>
            </div>
        </div>

        <div class="asteroid-orbit" id="cybele-orbit"></div>
        <div class="planet-container" id="cybele-container">
            <div class="asteroid" id="cybele">
                <div class="asteroid-name">Cybele</div>
            </div>
        </div>

        <div class="asteroid-orbit" id="eunomia-orbit"></div>
        <div class="planet-container" id="eunomia-container">
            <div class="asteroid" id="eunomia">
                <div class="asteroid-name">Eunomia</div>
            </div>
        </div>
    </div>

    <!-- Comets -->
    <div class="comet-orbit" id="halley-orbit"></div>
    <div class="planet-container" id="halley-container">
        <div class="comet" id="halley">
            <div class="comet-head"></div>
            <div class="comet-tail"></div>
            <div class="comet-name">Halley</div>
        </div>
    </div>

    <div class="comet-orbit" id="hale-bopp-orbit"></div>
    <div class="planet-container" id="hale-bopp-container">
        <div class="comet" id="hale-bopp">
            <div class="comet-head"></div>
            <div class="comet-tail"></div>
            <div class="comet-name">Hale-Bopp</div>
        </div>
    </div>

    <div class="comet-orbit" id="encke-orbit"></div>
    <div class="planet-container" id="encke-container">
        <div class="comet" id="encke">
            <div class="comet-head"></div>
            <div class="comet-tail"></div>
            <div class="comet-name">Encke</div>
        </div>
    </div>

    <div class="comet-orbit" id="tempel1-orbit"></div>
    <div class="planet-container" id="tempel1-container">
        <div class="comet" id="tempel1">
            <div class="comet-head"></div>
            <div class="comet-tail"></div>
            <div class="comet-name">Tempel 1</div>
        </div>
    </div>

    <div class="comet-orbit" id="wild2-orbit"></div>
    <div class="planet-container" id="wild2-container">
        <div class="comet" id="wild2">
            <div class="comet-head"></div>
            <div class="comet-tail"></div>
            <div class="comet-name">Wild 2</div>
        </div>
    </div>

    <div class="comet-orbit" id="churyumov-orbit"></div>
    <div class="planet-container" id="churyumov-container">
        <div class="comet" id="churyumov">
            <div class="comet-head"></div>
            <div class="comet-tail"></div>
            <div class="comet-name">Churyumov-Gerasimenko</div>
        </div>
    </div>

    <div class="comet-orbit" id="swift-tuttle-orbit"></div>
    <div class="planet-container" id="swift-tuttle-container">
        <div class="comet" id="swift-tuttle">
            <div class="comet-head"></div>
            <div class="comet-tail"></div>
            <div class="comet-name">Swift-Tuttle</div>
        </div>
    </div>

    <div class="comet-orbit" id="borrelly-orbit"></div>
    <div class="planet-container" id="borrelly-container">
        <div class="comet" id="borrelly">
            <div class="comet-head"></div>
            <div class="comet-tail"></div>
            <div class="comet-name">Borrelly</div>
        </div>
    </div>

    <div class="comet-orbit" id="giacobini-orbit"></div>
    <div class="planet-container" id="giacobini-container">
        <div class="comet" id="giacobini">
            <div class="comet-head"></div>
            <div class="comet-tail"></div>
            <div class="comet-name">Giacobini-Zinner</div>
        </div>
    </div>

    <div class="comet-orbit" id="hartley2-orbit"></div>
    <div class="planet-container" id="hartley2-container">
        <div class="comet" id="hartley2">
            <div class="comet-head"></div>
            <div class="comet-tail"></div>
            <div class="comet-name">Hartley 2</div>
        </div>
    </div>

    <!-- Restore Pluto -->
    <div class="orbit" id="pluto-orbit"></div>
    <div class="planet-container" id="pluto-container">
        <div class="planet" id="pluto">
            <div class="planet-name">Pluto</div>
        </div>
    </div>

    <!-- Spacecraft and Artificial Satellites -->
    <div class="spacecraft-orbit" id="voyager1-orbit"></div>
    <div class="planet-container" id="voyager1-container">
        <div class="spacecraft" id="voyager1">
            <div class="spacecraft-body"></div>
            <div class="spacecraft-name">Voyager 1</div>
        </div>
    </div>

    <div class="spacecraft-orbit" id="voyager2-orbit"></div>
    <div class="planet-container" id="voyager2-container">
        <div class="spacecraft" id="voyager2">
            <div class="spacecraft-body"></div>
            <div class="spacecraft-name">Voyager 2</div>
        </div>
    </div>

    <div class="spacecraft-orbit" id="jwst-orbit"></div>
    <div class="planet-container" id="jwst-container">
        <div class="spacecraft" id="jwst">
            <div class="spacecraft-body"></div>
            <div class="spacecraft-name">James Webb</div>
        </div>
    </div>

    <div class="spacecraft-orbit" id="iss-orbit"></div>
    <div class="planet-container" id="iss-container">
        <div class="spacecraft" id="iss">
            <div class="spacecraft-body"></div>
            <div class="spacecraft-name">ISS</div>
        </div>
    </div>

    <div class="spacecraft-orbit" id="hubble-orbit"></div>
    <div class="planet-container" id="hubble-container">
        <div class="spacecraft" id="hubble">
            <div class="spacecraft-body"></div>
            <div class="spacecraft-name">Hubble</div>
        </div>
    </div>

    <div class="spacecraft-orbit" id="parker-orbit"></div>
    <div class="planet-container" id="parker-container">
        <div class="spacecraft" id="parker">
            <div class="spacecraft-body"></div>
            <div class="spacecraft-name">Parker Solar Probe</div>
        </div>
    </div>

    <div class="spacecraft-orbit" id="new_horizons-orbit"></div>
    <div class="planet-container" id="new_horizons-container">
        <div class="spacecraft" id="new_horizons">
            <div class="spacecraft-body"></div>
            <div class="spacecraft-name">New Horizons</div>
        </div>
    </div>

    <div class="spacecraft-orbit" id="cassini-orbit"></div>
    <div class="planet-container" id="cassini-container">
        <div class="spacecraft" id="cassini">
            <div class="spacecraft-body"></div>
            <div class="spacecraft-name">Cassini</div>
        </div>
    </div>

    <div class="spacecraft-orbit" id="juno-orbit"></div>
    <div class="planet-container" id="juno-container">
        <div class="spacecraft" id="juno">
            <div class="spacecraft-body"></div>
            <div class="spacecraft-name">Juno</div>
        </div>
    </div>

    <div class="spacecraft-orbit" id="maven-orbit"></div>
    <div class="planet-container" id="maven-container">
        <div class="spacecraft" id="maven">
            <div class="spacecraft-body"></div>
            <div class="spacecraft-name">MAVEN</div>
        </div>
    </div>

    <script>
        // NASA Horizons API endpoint
        const HORIZONS_API_URL = 'https://ssd.jpl.nasa.gov/api/horizons.api';
        
        // Planet IDs in Horizons system
        const PLANET_IDS = {
            mercury: '199',  // Mercury
            venus: '299',    // Venus
            earth: '399',    // Earth
            mars: '499',     // Mars
            jupiter: '599',  // Jupiter
            saturn: '699',   // Saturn
            uranus: '799',   // Uranus
            neptune: '899',  // Neptune
            pluto: '999'     // Pluto
        };

        // Orbital periods remain as fallback
        const orbitalPeriods = {
            mercury: 87.97,
            venus: 224.7,
            earth: 365.26,
            mars: 686.98,
            jupiter: 4332.59,
            saturn: 10759.22,
            uranus: 30688.5,
            neptune: 60195,
            pluto: 90560    // Pluto's orbital period in Earth days
        };

        // Updated mean longitude and ascending node for Feb 2025
        const meanLongitudeJ2000 = {
            mercury: 252.25 - 48.3,  // Adjusted for Feb 2025 position
            venus: 181.98 + 85.5,    // Adjusted to be closer to Earth
            earth: 100.46 + 51.2,    // Base position for Earth
            mars: 355.45 + 160.3,    // Adjusted for Cancer position
            jupiter: 34.40 + 82.5,   // Adjusted for Gemini position
            saturn: 50.08 + 45.8,    // Adjusted for current position
            uranus: 314.05 + 68.2,   // Adjusted for current position
            neptune: 304.35 + 37.1,   // Adjusted for current position
            pluto: 238.92 + 14.3    // Pluto's mean longitude adjusted for Feb 2025
        };

        // Longitude of ascending node (degrees)
        const ascendingNode = {
            mercury: 48.331,
            venus: 76.680,
            earth: 0,
            mars: 49.558,
            jupiter: 100.464,
            saturn: 113.665,
            uranus: 74.006,
            neptune: 131.784,
            pluto: 110.299    // Pluto's ascending node
        };

        // Argument of perihelion (degrees)
        const argPerihelion = {
            mercury: 77.456,
            venus: 131.533,
            earth: 102.937,
            mars: 336.041,
            jupiter: 14.331,
            saturn: 92.432,
            uranus: 170.964,
            neptune: 44.971,
            pluto: 113.834    // Pluto's argument of perihelion
        };

        // Orbital eccentricities
        const eccentricities = {
            mercury: 0.205,
            venus: 0.007,
            earth: 0.017,
            mars: 0.093,
            jupiter: 0.048,
            saturn: 0.054,
            uranus: 0.047,
            neptune: 0.009,
            pluto: 0.248    // Pluto's eccentricity
        };

        // Orbital inclination to ecliptic (degrees)
        const inclinations = {
            mercury: 7.0,
            venus: 3.4,
            earth: 0.0,
            mars: 1.9,
            jupiter: 1.3,
            saturn: 2.5,
            uranus: 0.8,
            neptune: 1.8,
            pluto: 17.2    // Pluto's inclination
        };

        // Store last known good positions
        const lastKnownPositions = {
            mercury: null,
            venus: null,
            earth: null,
            mars: null,
            jupiter: null,
            saturn: null,
            uranus: null,
            neptune: null,
            pluto: null
        };

        // Reference epoch (J2000.0): January 1, 2000, 12:00 UTC
        const J2000 = new Date('2000-01-01T12:00:00Z');

        // Change the UPDATE_INTERVAL to 5 seconds
        const UPDATE_INTERVAL = 5000;

        function calculateKeplerEquation(meanAnomaly, eccentricity) {
            const M = meanAnomaly * Math.PI / 180;
            let E = M;
            
            // More iterations for better accuracy
            for (let i = 0; i < 8; i++) {
                E = E - (E - eccentricity * Math.sin(E) - M) / (1 - eccentricity * Math.cos(E));
            }
            
            const v = 2 * Math.atan(Math.sqrt((1 + eccentricity)/(1 - eccentricity)) * Math.tan(E/2));
            return v * 180 / Math.PI;
        }

        async function fetchPlanetPosition(planetId, date) {
            const params = new URLSearchParams({
                format: 'text',
                COMMAND: `'${planetId}'`,
                EPHEM_TYPE: 'VECTORS',
                CENTER: '@sun',
                TLIST: date.toISOString(),
                REF_PLANE: 'ECLIPTIC',
                VEC_TABLE: '2',  // Position vectors only
                CSV_FORMAT: 'YES'
            });

            try {
                console.log(`Fetching position for planet ID ${planetId} at ${date.toISOString()}`);
                console.log(`API URL: ${HORIZONS_API_URL}?${params}`);
                
                const response = await fetch(`${HORIZONS_API_URL}?${params}`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const text = await response.text();
                console.log('Raw API Response:', text);
                
                // Parse the vector data from the response
                // Example format:
                // 2025-02-20 21:02:00,   x,   y,   z
                const lines = text.split('\n');
                const dataLine = lines.find(line => line.includes(date.toISOString().split('T')[0]));
                
                if (dataLine) {
                    const [timestamp, x, y, z] = dataLine.split(',').map(s => s.trim());
                    console.log(`Parsed position data for ${planetId}:`, { x, y, z });
                    
                    return {
                        success: true,
                        position: { 
                            x: parseFloat(x), 
                            y: parseFloat(y), 
                            z: parseFloat(z)
                        }
                    };
                }
                
                console.warn(`No position data found for ${planetId} in response`);
                return {
                    success: false,
                    error: 'No position data found in API response'
                };
            } catch (error) {
                console.error('Failed to fetch planet position from Horizons API:', error);
                return {
                    success: false,
                    error: error.message
                };
            }
        }

        // Add asteroid IDs for NASA Horizons
        const ASTEROID_IDS = {
            ceres: '1',      // Ceres
            vesta: '4',      // Vesta
            pallas: '2',     // Pallas
            hygiea: '10',    // Hygiea
            interamnia: '704',  // Interamnia
            europa_52: '52',    // 52 Europa (asteroid)
            davida: '511',   // Davida
            sylvia: '87',    // Sylvia
            cybele: '65',    // Cybele
            eunomia: '15'    // Eunomia
        };

        // Asteroid orbital periods (days)
        const asteroidOrbitalPeriods = {
            ceres: 1681.63,      // Ceres
            vesta: 1325.75,      // Vesta
            pallas: 1685.93,     // Pallas
            hygiea: 2041.26,     // Hygiea
            interamnia: 1950.57,  // Interamnia
            europa_52: 2020.88,     // 52 Europa
            davida: 2001.75,     // Davida
            sylvia: 2381.64,     // Sylvia
            cybele: 2205.34,     // Cybele
            eunomia: 1570.89     // Eunomia
        };

        // Asteroid mean longitudes for Feb 2025
        const asteroidMeanLongitudeJ2000 = {
            ceres: 132.5,
            vesta: 103.8,
            pallas: 285.2,
            hygiea: 15.7,
            interamnia: 195.3,
            europa_52: 45.9,
            davida: 298.4,
            sylvia: 167.2,
            cybele: 88.6,
            eunomia: 222.1
        };

        // Asteroid orbit widths (in pixels, between Mars and Jupiter)
        const asteroidOrbitWidths = {
            ceres: 520,
            vesta: 480,
            pallas: 500,
            hygiea: 560,
            interamnia: 540,
            europa_52: 550,
            davida: 545,
            sylvia: 580,
            cybele: 570,
            eunomia: 490
        };

        // Add comet IDs for NASA Horizons
        const COMET_IDS = {
            halley: 'DES=1P',        // Halley
            'hale-bopp': 'DES=C/1995 O1',  // Hale-Bopp
            encke: 'DES=2P',         // Encke
            tempel1: 'DES=9P',       // Tempel 1
            wild2: 'DES=81P',        // Wild 2
            churyumov: 'DES=67P',    // Churyumov-Gerasimenko
            'swift-tuttle': 'DES=109P', // Swift-Tuttle
            borrelly: 'DES=19P',     // Borrelly
            giacobini: 'DES=21P',    // Giacobini-Zinner
            hartley2: 'DES=103P'     // Hartley 2
        };

        // Comet orbital periods (years)
        const cometOrbitalPeriods = {
            halley: 75.32,           // Halley
            'hale-bopp': 2537,       // Hale-Bopp
            encke: 3.3,              // Encke
            tempel1: 5.5,            // Tempel 1
            wild2: 6.39,             // Wild 2
            churyumov: 6.45,         // Churyumov-Gerasimenko
            'swift-tuttle': 133.28,  // Swift-Tuttle
            borrelly: 6.86,          // Borrelly
            giacobini: 6.62,         // Giacobini-Zinner
            hartley2: 6.46           // Hartley 2
        };

        // Convert orbital periods to days
        const cometOrbitalPeriodsInDays = Object.fromEntries(
            Object.entries(cometOrbitalPeriods).map(([key, value]) => [key, value * 365.25])
        );

        // Comet mean longitudes for Feb 2025
        const cometMeanLongitudeJ2000 = {
            halley: 180.5,
            'hale-bopp': 45.2,
            encke: 265.8,
            tempel1: 125.4,
            wild2: 315.7,
            churyumov: 195.3,
            'swift-tuttle': 85.9,
            borrelly: 275.6,
            giacobini: 155.2,
            hartley2: 235.8
        };

        // Comet orbit widths (in pixels, various elliptical orbits)
        const cometOrbitWidths = {
            halley: 1200,            // Highly elliptical orbit
            'hale-bopp': 1600,       // Very long orbit
            encke: 400,              // Short-period orbit
            tempel1: 600,
            wild2: 700,
            churyumov: 750,
            'swift-tuttle': 1000,
            borrelly: 800,
            giacobini: 850,
            hartley2: 650
        };

        // Add grid generation function
        function createGrid() {
            const gridContainer = document.querySelector('.grid-container');
            const gridSize = 100; // Space between grid lines in pixels
            const numLinesX = 30; // Number of lines in X direction
            const numLinesY = 20; // Number of lines in Y direction

            // Create grid for each plane
            const planes = ['xy', 'xz', 'yz'];
            planes.forEach((plane, index) => {
                const grid = document.createElement('div');
                grid.className = `grid grid-${plane}`;
                
                // Create lines
                for (let i = 0; i <= numLinesX; i++) {
                    // X lines
                    const xLine = document.createElement('div');
                    xLine.className = 'grid-line grid-x';
                    xLine.style.left = `${i * gridSize}px`;
                    grid.appendChild(xLine);
                }
                
                for (let i = 0; i <= numLinesY; i++) {
                    // Y lines
                    const yLine = document.createElement('div');
                    yLine.className = 'grid-line grid-y';
                    yLine.style.top = `${i * gridSize}px`;
                    grid.appendChild(yLine);

                    // Z lines (connecting points)
                    if (plane === 'xy') {
                        const zLine = document.createElement('div');
                        zLine.className = 'grid-line grid-z';
                        zLine.style.left = `${i * gridSize}px`;
                        zLine.style.top = `${i * gridSize}px`;
                        zLine.style.transform = `translateZ(${-1000}px)`;
                        grid.appendChild(zLine);
                    }
                }

                // Position the grid plane
                switch(plane) {
                    case 'xy':
                        grid.style.transform = 'translateZ(-1000px)';
                        break;
                    case 'xz':
                        grid.style.transform = 'rotateX(90deg) translateZ(-1000px)';
                        break;
                    case 'yz':
                        grid.style.transform = 'rotateY(90deg) translateZ(-1500px)';
                        break;
                }

                gridContainer.appendChild(grid);
            });

            // Add axis labels
            const labels = ['X', 'Y', 'Z'];
            labels.forEach((label, index) => {
                const axisLabel = document.createElement('div');
                axisLabel.className = 'axis-label';
                axisLabel.textContent = label;
                
                switch(label) {
                    case 'X':
                        axisLabel.style.right = '10px';
                        axisLabel.style.bottom = '50%';
                        break;
                    case 'Y':
                        axisLabel.style.bottom = '10px';
                        axisLabel.style.left = '50%';
                        break;
                    case 'Z':
                        axisLabel.style.top = '10px';
                        axisLabel.style.left = '50%';
                        break;
                }
                
                gridContainer.appendChild(axisLabel);
            });
        }

        // Update the updatePlanetPositions function to include all celestial bodies
        async function updatePlanetPositions() {
            const now = new Date();
            document.getElementById('current-date').textContent = now.toLocaleDateString();
            document.getElementById('current-time').textContent = now.toLocaleTimeString();

            // Calculate timestamp for positions
            const timestamp = now.getTime();

            // Update all celestial bodies
            const planets = ['mercury', 'venus', 'earth', 'mars', 'jupiter', 'saturn', 'uranus', 'neptune', 'pluto'];
            const asteroids = ['ceres', 'vesta', 'pallas', 'hygiea', 'interamnia', 'europa_52', 'davida', 'sylvia', 'cybele', 'eunomia'];
            const comets = ['halley', 'hale-bopp', 'encke', 'tempel1', 'wild2', 'churyumov', 'swift-tuttle', 'borrelly', 'giacobini', 'hartley2'];
            
            // Update planets and their positions
            for (const planet of planets) {
                try {
                    // Calculate initial position using orbital periods
                    const daysSinceJ2000 = (now - J2000) / (1000 * 60 * 60 * 24);
                    const period = orbitalPeriods[planet];
                    const meanMotion = 360 / period;
                    let angle = (meanMotion * daysSinceJ2000 + meanLongitudeJ2000[planet]) % 360;
                    
                    // Try to get new position data from NASA
                    const apiData = await fetchPlanetPosition(PLANET_IDS[planet], now);
                    
                    if (apiData.success && apiData.position) {
                        // Calculate angle from API position data
                        const { x, y } = apiData.position;
                        angle = Math.atan2(y, x) * 180 / Math.PI;
                        lastKnownPositions[planet] = angle;
                    } else {
                        // Store calculated position
                        lastKnownPositions[planet] = angle;
                    }

                    const container = document.getElementById(`${planet}-container`);
                    const planetElement = document.getElementById(planet);
                    const orbit = document.getElementById(`${planet}-orbit`);
                    
                    if (container && planetElement && orbit) {
                        // Get orbit radius
                        const orbitRadius = parseInt(orbit.style.width || orbit.offsetWidth) / 2;
                        
                        // Calculate position
                        const angleRad = angle * Math.PI / 180;
                        const x = orbitRadius * Math.cos(angleRad);
                        const y = orbitRadius * Math.sin(angleRad);
                        
                        // Apply position
                        container.style.transform = `translate(${x}px, ${y}px)`;
                        
                        // Ensure visibility
                        container.style.display = 'block';
                        container.style.visibility = 'visible';
                        planetElement.style.display = 'block';
                        planetElement.style.visibility = 'visible';
                        planetElement.style.opacity = '1';
                        
                        // Update z-index based on y position for proper layering
                        const zIndex = Math.floor(1000 + y);
                        container.style.zIndex = zIndex;
                        planetElement.style.zIndex = zIndex;

                        // Force planet dimensions
                        const size = planet === 'jupiter' ? 40 : 
                                   planet === 'saturn' ? 35 :
                                   planet === 'uranus' ? 26 :
                                   planet === 'neptune' ? 25 :
                                   planet === 'earth' ? 20 :
                                   planet === 'venus' ? 18 :
                                   planet === 'mars' ? 16 : 12;
                        
                        planetElement.style.width = `${size}px`;
                        planetElement.style.height = `${size}px`;
                        
                        // Update Saturn's rings if applicable
                        if (planet === 'saturn') {
                            const rings = planetElement.querySelector('.saturn-rings');
                            if (rings) {
                                rings.style.display = 'block';
                                rings.style.visibility = 'visible';
                                rings.style.zIndex = zIndex - 1;
                            }
                        }
                    }
                } catch (error) {
                    console.error(`Error updating ${planet} position:`, error);
                    // Use last known position if available
                    if (lastKnownPositions[planet] !== null) {
                        const angle = lastKnownPositions[planet];
                        const container = document.getElementById(`${planet}-container`);
                        const planetElement = document.getElementById(planet);
                        const orbit = document.getElementById(`${planet}-orbit`);
                        
                        if (container && planetElement && orbit) {
                            const orbitRadius = parseInt(orbit.style.width || orbit.offsetWidth) / 2;
                            const angleRad = angle * Math.PI / 180;
                            const x = orbitRadius * Math.cos(angleRad);
                            const y = orbitRadius * Math.sin(angleRad);
                            container.style.transform = `translate(${x}px, ${y}px)`;
                            planetElement.style.display = 'block';
                            planetElement.style.visibility = 'visible';
                            planetElement.style.opacity = '1';
                        }
                    }
                }
            }

            // Update satellites
            for (const [planet, moons] of Object.entries(satellites)) {
                const planetContainer = document.getElementById(`${planet}-container`);
                if (!planetContainer) continue;

                moons.forEach(moon => {
                    const moonContainer = document.getElementById(`${moon.id}-container`);
                    const moonElement = document.getElementById(moon.id);
                    if (!moonContainer || !moonElement) return;

                    // Calculate moon's position
                    const angle = ((timestamp / (moon.orbitPeriod * 24 * 60 * 60 * 1000)) * 2 * Math.PI) % (2 * Math.PI);
                    const x = moon.orbitRadius * Math.cos(angle);
                    const y = moon.orbitRadius * Math.sin(angle);

                    // Update moon's position
                    moonContainer.style.transform = `translate(${x}px, ${y}px)`;
                    
                    // Ensure moon visibility
                    moonContainer.style.display = 'block';
                    moonContainer.style.visibility = 'visible';
                    moonElement.style.display = 'block';
                    moonElement.style.visibility = 'visible';
                    moonElement.style.opacity = '1';

                    // Update z-index based on y position
                    const zIndex = Math.floor(2000 + y); // Higher z-index than planets
                    moonContainer.style.zIndex = zIndex;
                    moonElement.style.zIndex = zIndex;
                });
            }

            // Update asteroids
            for (const asteroid of asteroids) {
                try {
                    // Set orbit sizes
                    const orbit = document.getElementById(`${asteroid}-orbit`);
                    if (orbit) {
                        orbit.style.width = `${asteroidOrbitWidths[asteroid]}px`;
                        orbit.style.height = `${asteroidOrbitWidths[asteroid]}px`;
                    }

                    // Calculate position
                    const daysSinceJ2000 = (now - J2000) / (1000 * 60 * 60 * 24);
                    const period = asteroidOrbitalPeriods[asteroid];
                    const meanMotion = 360 / period;
                    let angle = (meanMotion * daysSinceJ2000 + asteroidMeanLongitudeJ2000[asteroid]) % 360;

                    // Try to get position from NASA Horizons
                    const apiData = await fetchPlanetPosition(ASTEROID_IDS[asteroid], now);
                    
                    if (apiData.success && apiData.position) {
                        const { x, y } = apiData.position;
                        angle = Math.atan2(y, x) * 180 / Math.PI;
                    }

                    const container = document.getElementById(`${asteroid}-container`);
                    const asteroidElement = document.getElementById(asteroid);
                    
                    if (container && asteroidElement && orbit) {
                        const orbitRadius = parseInt(orbit.style.width) / 2;
                        const angleRad = angle * Math.PI / 180;
                        const x = orbitRadius * Math.cos(angleRad);
                        const y = orbitRadius * Math.sin(angleRad);
                        
                        container.style.transform = `translate(${x}px, ${y}px)`;
                        container.style.display = 'block';
                        container.style.visibility = 'visible';
                        
                        asteroidElement.style.display = 'block';
                        asteroidElement.style.visibility = 'visible';
                        asteroidElement.style.opacity = '1';
                        
                        const zIndex = Math.floor(1000 + y);
                        container.style.zIndex = zIndex;
                        asteroidElement.style.zIndex = zIndex;
                    }
                } catch (error) {
                    console.error(`Error updating ${asteroid} position:`, error);
                }
            }

            // Update comets
            for (const comet of comets) {
                try {
                    // Set orbit sizes
                    const orbit = document.getElementById(`${comet}-orbit`);
                    if (orbit) {
                        orbit.style.width = `${cometOrbitWidths[comet]}px`;
                        orbit.style.height = `${cometOrbitWidths[comet]}px`;
                    }

                    // Calculate position
                    const daysSinceJ2000 = (now - J2000) / (1000 * 60 * 60 * 24);
                    const period = cometOrbitalPeriodsInDays[comet];
                    const meanMotion = 360 / period;
                    let angle = (meanMotion * daysSinceJ2000 + cometMeanLongitudeJ2000[comet]) % 360;

                    // Try to get position from NASA Horizons
                    const apiData = await fetchPlanetPosition(COMET_IDS[comet], now);
                    
                    if (apiData.success && apiData.position) {
                        const { x, y } = apiData.position;
                        angle = Math.atan2(y, x) * 180 / Math.PI;
                    }

                    const container = document.getElementById(`${comet}-container`);
                    const cometElement = document.getElementById(comet);
                    const cometTail = cometElement?.querySelector('.comet-tail');
                    
                    if (container && cometElement && orbit) {
                        const orbitRadius = parseInt(orbit.style.width) / 2;
                        const angleRad = angle * Math.PI / 180;
                        const x = orbitRadius * Math.cos(angleRad);
                        const y = orbitRadius * Math.sin(angleRad);
                        
                        container.style.transform = `translate(${x}px, ${y}px)`;
                        container.style.display = 'block';
                        container.style.visibility = 'visible';
                        
                        cometElement.style.display = 'block';
                        cometElement.style.visibility = 'visible';
                        cometElement.style.opacity = '1';
                        
                        // Update comet tail direction (always pointing away from the sun)
                        if (cometTail) {
                            const tailAngle = Math.atan2(y, x) * 180 / Math.PI + 180;
                            cometTail.style.transform = `rotate(${tailAngle}deg)`;
                        }
                        
                        const zIndex = Math.floor(1000 + y);
                        container.style.zIndex = zIndex;
                        cometElement.style.zIndex = zIndex;
                    }
                } catch (error) {
                    console.error(`Error updating ${comet} position:`, error);
                }
            }

            // Update spacecraft positions
            await updateSpacecraftPositions(timestamp);

            // Schedule next update
            setTimeout(updatePlanetPositions, UPDATE_INTERVAL);
        }

        // Modify the initialization
        document.addEventListener('DOMContentLoaded', async () => {
            // Create 3D grid
            createGrid();
            
            // Force initial visibility of all objects
            const allObjects = document.querySelectorAll('.planet');
            allObjects.forEach(obj => {
                obj.style.display = 'block';
                obj.style.visibility = 'visible';
                obj.style.opacity = '1';
                
                // Ensure proper dimensions
                if (!obj.style.width || !obj.style.height) {
                    const planetId = obj.id;
                    if (planetId === 'jupiter') {
                        obj.style.width = '40px';
                        obj.style.height = '40px';
                    } else if (planetId === 'saturn') {
                        obj.style.width = '35px';
                        obj.style.height = '35px';
                    } else {
                        obj.style.width = '20px';
                        obj.style.height = '20px';
                    }
                }
                
                // Log initial state
                console.log(`Initial state for ${obj.id}:`, {
                    display: obj.style.display,
                    visibility: obj.style.visibility,
                    opacity: obj.style.opacity,
                    width: obj.style.width,
                    height: obj.style.height,
                    transform: obj.style.transform
                });
            });

            const allContainers = document.querySelectorAll('.planet-container');
            allContainers.forEach(container => {
                container.style.display = 'block';
                container.style.visibility = 'visible';
                container.style.transformOrigin = '50% 50%';
                container.style.width = '0';
                container.style.height = '0';
                
                // Log initial state
                console.log(`Initial state for container ${container.id}:`, {
                    display: container.style.display,
                    visibility: container.style.visibility,
                    transformOrigin: container.style.transformOrigin,
                    width: container.style.width,
                    height: container.style.height
                });
            });

            // Start updating planet positions
            await updatePlanetPositions();
        });

        const satellites = {
            earth: [{
                id: 'moon',
                orbitPeriod: 27.3, // days
                orbitRadius: 20
            }],
            mars: [{
                id: 'phobos',
                orbitPeriod: 0.32, // days
                orbitRadius: 12.5
            }, {
                id: 'deimos',
                orbitPeriod: 1.26, // days
                orbitRadius: 17.5
            }],
            jupiter: [{
                id: 'io',
                orbitPeriod: 1.77, // days
                orbitRadius: 30
            }, {
                id: 'europa',
                orbitPeriod: 3.55, // days
                orbitRadius: 40
            }, {
                id: 'ganymede',
                orbitPeriod: 7.15, // days
                orbitRadius: 50
            }, {
                id: 'callisto',
                orbitPeriod: 16.69, // days
                orbitRadius: 60
            }],
            saturn: [{
                id: 'titan',
                orbitPeriod: 15.95, // days
                orbitRadius: 45
            }, {
                id: 'rhea',
                orbitPeriod: 4.52, // days
                orbitRadius: 35
            }, {
                id: 'iapetus',
                orbitPeriod: 79.32, // days
                orbitRadius: 55
            }],
            uranus: [{
                id: 'titania',
                orbitPeriod: 8.71, // days
                orbitRadius: 35
            }, {
                id: 'oberon',
                orbitPeriod: 13.46, // days
                orbitRadius: 42.5
            }, {
                id: 'miranda',
                orbitPeriod: 1.41, // days
                orbitRadius: 27.5
            }],
            neptune: [{
                id: 'triton',
                orbitPeriod: 5.88, // days
                orbitRadius: 35
            }]
        };

        // Spacecraft IDs for NASA Horizons
        const SPACECRAFT_IDS = {
            voyager1: '-31',    // Voyager 1
            voyager2: '-32',    // Voyager 2
            jwst: '-170',       // James Webb Space Telescope
            iss: '-125',        // International Space Station
            hubble: '-48',      // Hubble Space Telescope
            parker: '-96',      // Parker Solar Probe
            new_horizons: '-98', // New Horizons
            cassini: '-82',     // Cassini (historical)
            juno: '-61',        // Juno
            maven: '-202'       // MAVEN
        };

        // Spacecraft orbital characteristics
        const spacecraft = {
            voyager1: {
                distance: 23400000000, // km from Sun (approximate as of 2024)
                speed: 17, // km/s
                direction: 35, // degrees from ecliptic
                scale: 2500 // Scaled distance for visualization
            },
            voyager2: {
                distance: 19400000000,
                speed: 15,
                direction: -48,
                scale: 2200
            },
            jwst: {
                distance: 1500000, // km from Earth
                orbitPeriod: 365, // days (orbits around L2 point)
                orbitRadius: 800000, // km
                scale: 400 // Scaled distance for visualization
            },
            iss: {
                altitude: 408, // km
                orbitPeriod: 0.0639, // days (92.68 minutes)
                orbitRadius: 6778, // km from Earth's center
                scale: 50
            },
            hubble: {
                altitude: 540,
                orbitPeriod: 0.0642, // days
                orbitRadius: 6920,
                scale: 50
            },
            parker: {
                perihelion: 6900000, // km (closest approach to Sun)
                aphelion: 108000000, // km (farthest from Sun)
                orbitPeriod: 88, // days
                scale: 100
            },
            new_horizons: {
                distance: 7900000000, // km from Sun
                speed: 14, // km/s
                direction: 44,
                scale: 1800
            },
            cassini: {
                orbitPeriod: 378, // days (Saturn orbit period)
                orbitRadius: 1200000, // km from Saturn
                scale: 800
            },
            juno: {
                orbitPeriod: 53, // days around Jupiter
                orbitRadius: 8000000, // km from Jupiter
                scale: 650
            },
            maven: {
                orbitPeriod: 4.5, // hours around Mars
                orbitRadius: 6000, // km from Mars
                scale: 450
            }
        };

        async function updateSpacecraftPositions(timestamp) {
            const now = new Date();
            
            for (const [craftId, horizonsId] of Object.entries(SPACECRAFT_IDS)) {
                try {
                    const apiData = await fetchPlanetPosition(horizonsId, now);
                    const container = document.getElementById(`${craftId}-container`);
                    const craftElement = document.getElementById(craftId);
                    const orbit = document.getElementById(`${craftId}-orbit`);
                    const craft = spacecraft[craftId];
                    
                    if (container && craftElement) {
                        let x, y, radius, angle;
                        
                        if (apiData.success && apiData.position) {
                            // Use real position data from NASA
                            const pos = apiData.position;
                            x = pos.x * craft.scale;
                            y = pos.y * craft.scale;
                        } else {
                            // Fallback calculations
                            switch(craftId) {
                                case 'iss':
                                case 'hubble':
                                    // Get Earth's position
                                    const earthContainer = document.getElementById('earth-container');
                                    const earthTransform = earthContainer ? earthContainer.style.transform : '';
                                    const earthMatch = earthTransform.match(/translate\(([-\d.]+)px,\s*([-\d.]+)px\)/);
                                    let earthX = 0, earthY = 0;
                                    
                                    if (earthMatch) {
                                        earthX = parseFloat(earthMatch[1]);
                                        earthY = parseFloat(earthMatch[2]);
                                    }
                                    
                                    // Calculate satellite position relative to Earth
                                    const satelliteAngle = (timestamp / (craft.orbitPeriod * 24 * 60 * 60 * 1000) * 360) % 360;
                                    const satelliteRadius = 20; // Small orbit visible around Earth
                                    x = earthX + satelliteRadius * Math.cos(satelliteAngle * Math.PI / 180);
                                    y = earthY + satelliteRadius * Math.sin(satelliteAngle * Math.PI / 180);
                                    
                                    // Update orbit to be centered on Earth
                                    if (orbit) {
                                        orbit.style.width = `${satelliteRadius * 2}px`;
                                        orbit.style.height = `${satelliteRadius * 2}px`;
                                        orbit.style.position = 'absolute';
                                        orbit.style.left = `${earthX}px`;
                                        orbit.style.top = `${earthY}px`;
                                    }
                                    break;

                                case 'voyager1':
                                case 'voyager2':
                                case 'new_horizons':
                                    radius = craft.scale;
                                    angle = (timestamp / (365.25 * 24 * 60 * 60 * 1000) * 360 + craft.direction) % 360;
                                    x = radius * Math.cos(angle * Math.PI / 180);
                                    y = radius * Math.sin(angle * Math.PI / 180);
                                    break;
                                    
                                case 'cassini':
                                    radius = 800; // Saturn's orbit radius + offset
                                    angle = (timestamp / (craft.orbitPeriod * 24 * 60 * 60 * 1000) * 360) % 360;
                                    x = radius * Math.cos(angle * Math.PI / 180);
                                    y = radius * Math.sin(angle * Math.PI / 180);
                                    break;
                                    
                                default:
                                    radius = craft.scale;
                                    angle = (timestamp / (craft.orbitPeriod * 24 * 60 * 60 * 1000) * 360) % 360;
                                    x = radius * Math.cos(angle * Math.PI / 180);
                                    y = radius * Math.sin(angle * Math.PI / 180);
                            }
                        }
                        
                        // Update position
                        container.style.transform = `translate(${x}px, ${y}px)`;
                        container.style.display = 'block';
                        container.style.visibility = 'visible';
                        
                        // Update spacecraft visibility
                        craftElement.style.display = 'block';
                        craftElement.style.visibility = 'visible';
                        craftElement.style.opacity = '1';
                        
                        // Update z-index
                        const zIndex = Math.floor(3000 + y);
                        container.style.zIndex = zIndex;
                        craftElement.style.zIndex = zIndex;
                        
                        // Update orbit path if applicable
                        if (orbit) {
                            const orbitSize = radius * 2;
                            orbit.style.width = `${orbitSize}px`;
                            orbit.style.height = `${orbitSize}px`;
                        }
                    }
                } catch (error) {
                    console.error(`Error updating ${craftId} position:`, error);
                }
            }
        }

        // ... existing code ...
    </script>
</body>
</html> 